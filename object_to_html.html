<!DOCTYPE html>
<html>
<head>
	<style type="text/css">
	*{
			margin: 0px;
			box-sizing: border-box;
			/*hej*/
	}

		#header{
			width: 100%;
			height: 100px;
			background-color: rgba(255,000,000,0.2);
		}
		#side-menu{
			width: 19%;
			height: 80vh;
			display: inline-block;
			background-color: rgba(000,255,000,0.2);


		}
		#main-body{
			width: 80%;
			height: 80vh;
			display: inline-block;
			background-color: rgba(0,0,255,0.2);

		}
	</style>
	<title></title>
</head>
<body id="root">

<div id="body">
	<div id="header">
		<div id="logo"></div>
	</div>
	<div id="side-menu"></div>
	<div id="main-body"></div>
</div>


<template id="card">
	<div class="test">
		<p id="cardContent">card</p>
	</div>
</template>

<script type="text/javascript">
	
	var obj = {
		root: true,
		children: [
			{
				lastChild: false,
				destination: 'body',
				content: '',
				eventListener: function(callback){
					callback();
						},
				children: [
					{
						lastChild: false,
						destination: 'header',
						content: 'Rubriken',
						eventListener: function(callback){
							callback();
						},
						children: [
							{
								lastChild: true,
								destination: 'logo',
								content: 'bild.img',
								eventListener: function(callback){
									callback();
								},
								children: [
								],
							},
						],
					},
					{
						lastChild: false,
						destination: 'side-menu',
						content: 'en produkt kategori typ datorer',
						eventListener: function(callback){
							callback();
						},
						children: [
							{
								lastChild: false,
								destination: 'side-menu',
								content: 'en produkt kategori typ Dell',
								eventListener: function(callback){
									callback();
								},
								children: [
									{	
										lastChild: false,
										destination: 'side-menu',
										content: 'bärbara',
										eventListener: function(callback){
											callback();
										},
										children: [
											{	
												lastChild: true,
												destination: 'main-body',
												content: 'Dell - A2345',
												eventListener: function(callback){
													callback();
												},
												children: 
												[]
											},
										],
									},
								],
							},
						],
					},
				]
			}
		],
	}

	function extractContent(data, dest){
		console.log('start ',data, dest);
		if(data.root){
			//Första loopen, kanske göra något särskilt just här?
			console.log('if root, bara en gång');
			var parentElement = createPartialHtml('', 'div', ['root']);
			console.log(parentElement);
			var children = data.children;
			for (var i = 0; i < children.length; i++) {
				console.log(children[i], parentElement);
				var childElement = createPartialHtml(children[i].content, 'p', ['child']);
				extractContent(childElement, parentElement);
			}
		}else if(!data.root){
			//replaceHtml(data, dest);
			var children = data.children;
			//var parentElement = createPartialHtml(data.content, 'div', ['notRoot']);
			for (var i = 0; i < children.length; i++) {
				if(!children[i].lastChild){
					var childElement = createPartialHtml(children[i].content, 'p', ['child']);
					var newElement = mergeParentChild(data, childElement);
					//appendHtml(newElement, children[i].destination);
					console.log(newElement);
					extractContent(children[i], newElement);
				}else{
					//console.log(' endpoint ', children[i].content, ' insert in parent ', children[i].destination);
					var childElement = createPartialHtml(children[i].content, 'p', ['child']);
					var newElement = mergeParentChild(parentElement, childElement);
					extractContent(children[i], newElement);
					//appendHtml(newElement, children[i].destination);
				}
			}
		}
	}
	function replaceHtml(html, dest){
		//console.log(dest, document.getElementById(dest));
		while (document.getElementById(dest).firstChild) document.getElementById(dest).removeChild(document.getElementById(dest).firstChild);
		document.getElementById(dest).appendChild(html)
	}

	function appendHtml(html, dest){
		document.getElementById(dest).appendChild(html)
	}

	function createPartialHtml(content, type, style){

		var html = document.createElement(type);
		for (var i = 0; i < style.length; i++) {
			html.classList.add(style[i]);
		}
		html.innerHTML = content;

		return html
	}

	function mergeParentChild(parent, child){

		if(typeof(child) == 'string'){
			var template = document.createElement('template');
		    template.innerHTML = child;
			parent.appendChild(template.content.firstChild);
		}else{
			parent.appendChild(child);
		}
	    return parent;

	}
	var p = createPartialHtml('hej', 'p', ['p-tag']);
	var h1 = createPartialHtml('Rubrik', 'h1', ['h1-tag']);

	/*appendHtml(h1, 'logo');
	appendHtml(p, 'logo');
*/

	extractContent(obj, 'body');

</script>
</body>
</html>